---
title: "Data_Renaming"
output: html_document
---

```{r, message=FALSE}
library("knitr")      # for knitting
library("broom")      # for tidying model fits
library("GGally")     # for ggpairs plot
library("tidyverse")  # for everything else
library("dplyr") 
library("tidyr")
library("tibble")
library("Hmisc")
library("corrplot")
library("fs")
```

```{r}
folder_path <- "/Volumes/CU_HD/research/data/DS7_Validation/ENI_072/text/"

# read the input text file
data <- read.table(paste0(folder_path, "RLS_c001_old.txt"), header = TRUE, fill = TRUE)

# define a function to replace values in a column
replace_values <- function(x) {
  x <- as.character(x)
  x[x == "P4-A"] <- "hc004-Avg"
  x[x == "Fz-A"] <- "hc001-Avg"
  x[x == "Pz-A"] <- "hc002-Avg"
  x[x == "P3-A"] <- "hc003-Avg"
  x[x == "PO8-A"] <- "hc005-Avg"
  x[x == "PO7-A"] <- "hc006-Avg"
  x[x == "Oz-A"] <- "hc007-Avg"
  return(x)
}

# apply the function to the specified column
data$iCh <- replace_values(data$iCh)

# save the modified data to a new text file in the same folder
write.table(data, file = paste0(folder_path, "new_RLS_c001.txt"), sep = "\t", row.names = FALSE, quote=FALSE)
```

Renaming channels and saving it as new txt

```{r setup, include=FALSE}
# Define the main folder path
main_folder <-"/Volumes/CU_HD/research/data/DS7_renamed"

# List all subject folders starting with "ENI"
subject_folders <- list.dirs(path = main_folder, full.names = TRUE, recursive = FALSE)
subject_folders <- subject_folders[grep("ENI", subject_folders)]

# Define the column replacement function
replace_values <- function(x) {
  x <- as.character(x)
  x[x == "P4-A"] <- "hc004-Avg"
  x[x == "Fz-A"] <- "hc001-Avg"
  x[x == "Pz-A"] <- "hc002-Avg"
  x[x == "P3-A"] <- "hc003-Avg"
  x[x == "PO8-A"] <- "hc005-Avg"
  x[x == "PO7-A"] <- "hc006-Avg"
  x[x == "Oz-A"] <- "hc007-Avg"
  return(x)
}

# Loop through each subject folder
for (subject_folder in subject_folders) {
  # Construct the path to the "text" folder within the subject folder
  text_folder <- file.path(subject_folder, "text")
  
  # Check if the "text" folder exists
  if (dir.exists(text_folder)) {
    # Locate the RLS_c001.txt file within the "text" folder
    rls_file <- list.files(path = text_folder, pattern = "RLS_c003.txt", full.names = TRUE, recursive = FALSE)
    
    # Check if RLS_c001.txt file exists
    if (length(rls_file) > 0) {
      # Read the RLS_c001.txt file
      data <- read.table(rls_file, header = TRUE, fill = TRUE)
      
      # Apply the column replacement function
      data$iCh <- replace_values(data$iCh)
      
      # Save the modified data to a new text file in the same folder
      new_file_path <- sub("\\.txt$", "_new.txt", rls_file)
      write.table(data, file = new_file_path, sep = "\t", row.names = FALSE)
      
      cat("Modified file saved to:", new_file_path, "\n")
    } else {
      cat("RLS_c001.txt file not found in:", text_folder, "\n")
    }
  } else {
    cat("text folder not found in:", subject_folder, "\n")
  }
}

```

Rename old files
```{r}
# Define the main folder path
main_folder <-"/Volumes/CU_HD/research/data/DS7_renamed"

# List all subject folders starting with "ENI"
subject_folders <- list.dirs(path = main_folder, full.names = TRUE, recursive = FALSE)
subject_folders <- subject_folders[grep("ENI", subject_folders)]

# Loop through each subject folder
for (subject_folder in subject_folders) {
  # Construct the path to the "text" folder within the subject folder
  text_folder <- file.path(subject_folder, "text")
  
  # Check if the "text" folder exists
  if (dir.exists(text_folder)) {
    # Locate the RLS_c001.txt file within the "text" folder
    rls_file <- list.files(path = text_folder, pattern = "RLS_c003_new.txt", full.names = TRUE, recursive = FALSE)
    
    # Check if RLS_c001.txt file exists
    if (length(rls_file) > 0) {
      # Rename the file to RLS_c001_old.txt
      new_file_path <- sub("RLS_c003_new.txt", "RLS_c003.txt", rls_file)
      file.rename(rls_file, new_file_path)
      
      cat("File renamed to:", new_file_path, "\n")
    } else {
      cat("RLS_c001.txt file not found in:", text_folder, "\n")
    }
  } else {
    cat("text folder not found in:", subject_folder, "\n")
  }
}
```

Taking out Nas with empty strings
```{r}
# Define the main folder path
main_folder <- "/Volumes/CU_HD/research/data/DS7_renamed"

# List all subject folders starting with "ENI"
subject_folders <- list.dirs(path = main_folder, full.names = TRUE, recursive = FALSE)
subject_folders <- subject_folders[grep("ENI", subject_folders)]

# Loop through each subject folder
for (subject_folder in subject_folders) {
  # Construct the path to the "text" folder within the subject folder
  text_folder <- file.path(subject_folder, "text")
  
  # Check if the "text" folder exists
  if (dir.exists(text_folder)) {
    # Locate the RLS_c001.txt file within the "text" folder
    rls_file <- list.files(path = text_folder, pattern = "RLS_c003.txt", full.names = TRUE, recursive = FALSE)
    
    # Check if RLS_c001.txt file exists
    if (length(rls_file) > 0) {
      # Read the RLS_c001.txt file
      data <- read.table(rls_file, header = TRUE, fill = TRUE)
      
      # Replace NAs with empty strings
      data[is.na(data)] <- ""
      
      # Save the modified data back to the same file
      write.table(data, file = rls_file, sep = "\t", row.names = FALSE)
      
      cat("NAs replaced with empty strings in:", rls_file, "\n")
    } else {
      cat("RLS_c001.txt file not found in:", text_folder, "\n")
    }
  } else {
    cat("text folder not found in:", subject_folder, "\n")
  }
}
```

Rename new files as regular RLS's so code can run it

```{r}
# Define the main folder path
main_folder <-"/Volumes/CU_HD/research/data/DS7_Validation"

# List all subject folders starting with "ENI"
subject_folders <- list.dirs(path = main_folder, full.names = TRUE, recursive = FALSE)
subject_folders <- subject_folders[grep("ENI", subject_folders)]

# Loop through each subject folder
for (subject_folder in subject_folders) {
  # Construct the path to the "text" folder within the subject folder
  text_folder <- file.path(subject_folder, "text")
  
  # Check if the "text" folder exists
  if (dir.exists(text_folder)) {
    # Locate the RLS_c001.txt file within the "text" folder
    rls_file <- list.files(path = text_folder, pattern = "RLS_c003_new.txt", full.names = TRUE, recursive = FALSE)
    
    # Check if RLS_c001.txt file exists
    if (length(rls_file) > 0) {
      # Rename the file to RLS_c001_old.txt
      new_file_path <- sub("RLS_c003_new.txt$", "RLS_c003.txt", rls_file)
      file.rename(rls_file, new_file_path)
      
      cat("File renamed to:", new_file_path, "\n")
    } else {
      cat("RLS_c001.txt file not found in:", text_folder, "\n")
    }
  } else {
    cat("text folder not found in:", subject_folder, "\n")
  }
}
```