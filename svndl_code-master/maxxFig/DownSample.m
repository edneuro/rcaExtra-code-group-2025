function tRS = DownSample( tR )[ tNT, tNCh, tNS ] = size( tR );tT = linspace( 0, 1000, tNT )';% tR = GetARMA( size( tT ), 0.9, 0.01 );% figure; plot( tT, tR );tIT = [ 1:tNT ]'; % vector of time indices for reconstructing down-sampled waveform in original time basetISamp = zeros( size( tIT ) ); % vector of sample indices for reconstructing down-sampled waveform in original time basetTInt = [ 0 50:5:100 110:10:200 220:20:400 500 ]';% tTInt = [ 0 580:10:650 1000 ]';tTInt = [ tTInt( 1:( end-1 ) ) tTInt( 2:end ) ];tTInt = cat( 1, tTInt, tTInt + 500 );tNInt = size( tTInt, 1 );tRS = zeros( [ tNInt, tNCh, tNS ] ); % vector of downsampled waveform datafor iTInt = 1:tNInt% 	tISamp( tIT( tT > tTInt( iTInt, 1 ) & tT <= tTInt( iTInt, 2 ) ), : ) = iTInt;	tRange = tIT( tT > tTInt( iTInt, 1 ) & tT <= tTInt( iTInt, 2 ) );	tISamp( tRange ) = iTInt;	tRS( iTInt, :, : ) = mean( tR( tRange, :, : ) );endtISamp( 1 ) = 1;tRS = tRS( tISamp, :, : );% figure; plot( tT, tISamp );% figure; plot( tT, tRS( tISamp ) );figure;tT = linspace( tTInt( 1 ), tTInt( end ), size( tRS, 1 ) )';whosfor iCh = 1:tNCh 	subplot( tNCh, 1, iCh );	hold on;	plot( tT, squeeze( tRS( :, iCh, : ) ), 'm-' );	tRM = squeeze( mean( tRS( :, iCh, : ), 3 ) );	plot( tT, tRM, 'c-', 'linewidth', 3 );	axis tight;endtH = allchild( gcf );tPos = get( tH, 'position' );tPos = cat( 1, tPos{:} );tYLim = get( tH, 'ylim' );tYLim = cat( 1, tYLim{:} );tYLim = [ min( tYLim( :, 1 ) ) max( tYLim( :, 2 ) ) ];for iCh = 1:tNCh	set( tH( iCh ), 'position', tPos( iCh, : ) + [ 0, -0.01, 0, 0.02 ], 'ylim', tYLim );end