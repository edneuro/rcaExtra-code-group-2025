function FindFUTS( tDD, tRefDist, tSPM, tiFU )[tNSamples, tNChans, tNSubj ] = size( tDD );tMaxRD = max( tRefDist, [], 2 );tMFTail = flipud( sort( tMaxRD( tMaxRD > prctile( tMaxRD, 97.5 ) ) ) );tTS = tMFTail( tiFU )tPermInt = find( tMaxRD == tTS )tPermSgn = tSPM( tPermInt, :, : );tPermTS = TScore( tDD .* repmat( tPermSgn, [tNSamples tNChans 1] ) );% max( tPermTS(:) )tAbsPerm = find( tPermTS == max( tPermTS(:) ) )[ iR, iC ] = find( tPermTS == max( tPermTS(:) ) );% TScore( tDD( iR, iC, : ) .* tPermSgn )[	squeeze( tDD( iR, iC, : ) ) ...	squeeze( tPermSgn ) ...	squeeze( tDD( iR, iC, : ) .* tPermSgn ) ]function rv = TScore( tX1 ) % tX is NSamples x NChan x NSub, rv is NSamples x  NChanrv = mean( tX1, 3 ) ./ std( tX1, 0, 3 ) .* sqrt( size( tX1, 3 ) );